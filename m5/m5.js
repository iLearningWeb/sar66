const question = document.getElementById("question");
const choices = Array.from(document.getElementsByClassName("choice-text"));
const progressText = document.getElementById("progressText");
const scoreText = document.getElementById("score");
const progressBarFull = document.getElementById("progressBarFull");
const quizname = document.getElementById("quizname");
//mod here to match the SAR66 Topic content

let currentQuestion = {};
let acceptingAnswers = false;
let score = 0;
let questionCounter = 0;
let availableQuesions = [];
//set your questions here
let questions = [
  {question: "The radome protective coating cannot easily dissipate static electricity because it is made of:",
  choice1: "a metallic material.",
  choice2: "non-conductive material.",
  choice3: "conductive material.",
  answer: 2},
  {question: "The metal points of the null field dischargers are:",
  choice1: "positioned at right angles to the direction of flight.",
  choice2: "positioned parallel to the direction of flight.",
  choice3: "protected from the slipstream during flight.",
  answer: 2},
  {question: "The data in a digital computer is stored in the:",
  choice1: "central processor unit.",
  choice2: "memory unit.",
  choice3: "power supply.",
  answer: 2},
  {question: "An optical fibre cleaver is a tool:",
  choice1: "for joining the cable.",
  choice2: "for polishing the fibre.",
  choice3: "that precisely breaks the fibre.",
  answer: 3},
  {question: "The two display units used in a typical electronic flight instrument system are an electronic:",
  choice1: "attitude direction indicator and an electronic direction indicator.",
  choice2: "attitude direction indicator and an electronic horizontal situation indicator.",
  choice3: "?",
  answer: 2},
  {question: "Lighting diverters are:",
  choice1: "rubber insulators attached to the radome abrasion shield.",
  choice2: "metal covers which protect the primary flight control surfaces.",
  choice3: "thin metallic foil strips adhered to the radome abrasion shield.",
  answer: 3},
  {question: "A three-input logic gate with a high output when two-inputs are low and one-input is high is:",
  choice1: "an “AND” gate",
  choice2: "an “NOR” gate",
  choice3: "an “OR” gate",
  answer: 3},
  {question: "In an aircraft computer system, a “peripheral device” is:",
  choice1: "the power supply used by the computer.",
  choice2: "the wiring loom connecting external devices to the CPU.",
  choice3: "an external accessory that is not part of the basic computer system.",
  answer: 3},
  {question: "For the numeral eight to be shown on a 7 segment liquid crystal display, there would need to be:",
  choice1: "five segments displayed.",
  choice2: "seven segments displayed.",
  choice3: "six segments displayed.",
  answer: 2},
  {question: "Any Field Loadable Software (FLS) should be recorded in the:",
  choice1: "aircraft’s Technical Log, with a copy kept in the operator’s maintenance records.",
  choice2: "Aircraft Configuration List, and a copy kept on board the aircraft and another copy kept in the operator’s maintenance records.",
  choice3: "aircraft’s Maintenance Manual, with a copy kept in the operator’s maintenance records.",
  answer: 2},
  {question: "In a computer system the term “PROM” is an abbreviation for:",
  choice1: "Programmers Repair and Operation Manual.",
  choice2: "Prominent device.",
  choice3: "Programmable Read Only Memory.",
  answer: 3},
  {question: "An ARINC 429 word has ____ bits.",
  choice1: "32",
  choice2: "16",
  choice3: "64",
  answer: 1},
  {question: "The captain’s electronic attitude director indicator displays:",
  choice1: "pitch and roll attitude indications.",
  choice2: "altitude and direction indications.",
  choice3: "altitude, windspeed and wind direction data.",
  answer: 1},
  {question: "For a LCD crystal display pixel to be dark, the LCD pixel shutter:",
  choice1: "remains in its normal opaque condition.",
  choice2: "transparent.",
  choice3: "is back lit.",
  answer: 1},
  {question: "Computer storage media should be clearly labeled and stored in:",
  choice1: "an anti-static bag.",
  choice2: "a non-metallic container.",
  choice3: "lint-free material, sealed in a closed box.",
  answer: 1},
  {question: "The truth table for a three-input “OR” gate has:",
  choice1: "three true output conditions.",
  choice2: "four true output conditions.",
  choice3: "seven true output conditions.",
  answer: 3},
  {question: "Over-tightening cable ties supporting a fibre optic cable can:",
  choice1: "increase the attenuation.",
  choice2: "increase the impedance.",
  choice3: "increase the resistance.",
  answer: 1},
  {question: "The hexadecimal number A is equivalent to the octal number:",
  choice1: "12.",
  choice2: "8.",
  choice3: "C.",
  answer: 1},
  {question: "When failure of data signals occurs, indication is given on EFIS display units by flags displayed in:",
  choice1: "yellow.",
  choice2: "red.",
  choice3: "magenta.",
  answer: 1},
  {question: "The logic symbol for inversion is a:",
  choice1: "triangle.",
  choice2: "semi-circle.",
  choice3: "small circle.",
  answer: 3},
  {question: "An analogue to digital converter:",
  choice1: "decodes the binary input and generates a binary coded output.",
  choice2: "samples the input voltage and generates a binary coded output.",
  choice3: "decodes the digital input and generates a continuous electrical output.",
  answer: 2},
  {question: "A Procured Loadable Aircraft Software Part must be accompanied by a:",
  choice1: "release form signed by a senior maintenance officer.",
  choice2: "FAA 8130-3 or equivalent.",
  choice3: "list of the aircraft that the software is approved for.",
  answer: 2},
  {question: "The aircraft configuration list (ACL) is an aircraft-specific list of:",
  choice1: "line replaceable units and modules with a loadable software aircraft part (LSAP).",
  choice2: "software versions of the components that comprise the flight management system.",
  choice3: "software which can be used by a variety of different aircraft types.",
  answer: 1},
  {question: "The analogue to digital converter output is a:",
  choice1: "series of electrical pulses.",
  choice2: "sine wave.",
  choice3: "continuous electrical signal.",
  answer: 1},
  {question: "In regard to aircraft avionics systems ESDS stands for:",
  choice1: "electrostatic discharge sensitive.",
  choice2: "electronic safety and design standard.",
  choice3: "equalisation safe device surface.",
  answer: 1},
  {question: "Inertial navigation systems derive their basic information from:",
  choice1: "vertical gyros.",
  choice2: "rate gyro.",
  choice3: "accelerometers.",
  answer: 3},
  {question: "A decimal number can be converted into an equivalent binary number by repeated dividing the number by:",
  choice1: "8.",
  choice2: "2.",
  choice3: "10.",
  answer: 2},
  {question: "What is the format of the data in a wire carrying multiplexed data?",
  choice1: "Serial data words.",
  choice2: "Parallel data words.",
  choice3: "Both serial and parallel data words can be used.",
  answer: 1},
  {question: "In a de-multiplexer or data selector, the AND gate that is open for passage of data from one input is the one whose inputs are:",
  choice1: "all “1”.",
  choice2: "connected to the “true” input line.",
  choice3: "connected to the “complement” input line.",
  answer: 1},
  {question: "The data from the Inertial Reference System (IRS) is used for:",
  choice1: "pitch and roll displays.",
  choice2: "pitch, roll and yaw displays.",
  choice3: "pitch and yaw displays.",
  answer: 2},
  {question: "The four modes of the electronic horizontal situation indicator are:",
  choice1: "VOR, ILS, Map and Plan.",
  choice2: "VOR, ILS, DME and Map.",
  choice3: "VOR, ILS, DME and Plan.",
  answer: 1},
  {question: "The octal number 15 is equivalent to the hexadecimal number:",
  choice1: "21",
  choice2: "D",
  choice3: "13",
  answer: 2},
  {question: "An altitude digital encoder in a central air data computer is used:",
  choice1: "only in turbine powered aircraft.",
  choice2: "for transmission to ATC.",
  choice3: "only in glass-cockpit aircraft.",
  answer: 2},
  {question: "To produce a quality splice in a fibre optic cable, the fibre ends must be cut at ___ degrees to the fibre length.",
  choice1: "90",
  choice2: "85",
  choice3: "45",
  answer: 1},
  {question: "When installing an ESD bonding jumper it is important that the clips:",
  choice1: "make a good electrical connection.",
  choice2: "are not connected during electrical storms.",
  choice3: "are fully insulated from ground.",
  answer: 1},
  {question: "A disadvantage of the liquid crystal display (LCD) is:",
  choice1: "a lack of proper heat dissipation.",
  choice2: "excessive weight.",
  choice3: "limited off-axis viewing.",
  answer: 3},
  {question: "The binary number 1010 is equivalent to the decimal number:",
  choice1: "22.",
  choice2: "12.",
  choice3: "10.",
  answer: 3},
  {question: "The digital to analogue converter output is a:",
  choice1: "series of electrical pulses.",
  choice2: "continuous electrical signals.",
  choice3: "sine wave.",
  answer: 2},
  {question: "An In-Circuit Emulator (ICE) is:",
  choice1: "a device to test and debug a computer system.",
  choice2: "a multi-plug adapter used to interface dissimilar computer systems.",
  choice3: "an analogue to digital converter used when modernizing older aircraft.",
  answer: 1},
  {question: "Which of the following encoders can be found in the ARINC 429?\n1. Discrete\n2. BCD\n3. Octal\n4. Grey\n5. BNR\n6. Excess-3\n7. Hexadecimal\n8. ASCII:",
  choice1: "1, 2 and 5",
  choice2: "1, 2 and 3",
  choice3: "2, 5 and 8",
  answer: 1},
  {question: "The individual pixels of a 256 x 256 display is driven by the output from a:",
  choice1: "multiplexer.",
  choice2: "de-multiplexer",
  choice3: "modulator",
  answer: 2},
  {question: "The electronic distribution of software by the producer or supplier is:",
  choice1: "not supported by aircraft manufacturers.",
  choice2: "only approved for software with a file size of less than 1 megabyte.",
  choice3: "an acceptable means of distributing software.",
  answer: 1},
  {question: "An electrostatic discharge caused by incorrect handling procedures:",
  choice1: "does not harm electronic components.",
  choice2: "can partially weaken the component but not immediately affect its performance.",
  choice3: "will only occur during the removal and installation of avionics equipment.",
  answer: 3},
  {question: "The main building blocks of a digital computer are:",
  choice1: "LC input devices, control unit, output devices, arithmetic unit, and memory.",
  choice2: "LC display, CPU, hard disk drive, application software, and printer.",
  choice3: "RAM, ROM, ALU, clock, and registers.",
  answer: 1},
  {question: "Multiplexer “data select” inputs control:",
  choice1: "which input will be switched to the output.",
  choice2: "when the inputs will be clocked to the output.",
  choice3: "how many inputs will be switched to the output.",
  answer: 1},
  {question: "Where are the Flight Director pitch and roll bars or ‘V-Bars’ typically displayed?",
  choice1: "On the Electronic Attitude Direction Indicator (EADI)",
  choice2: "On the Electronic Horizontal Situation Indicator (EHSI)",
  choice3: "Electronic Centralised Aircraft Monitoring Display Unit (ECAM DU)",
  answer: 1},
  {question: "In a computer, the arithmetic and logic unit is:",
  choice1: "basically a combined logic element that can do both arithmetic and logic operations on integer numbers.",
  choice2: "a logic element that arithmetically converts high level programming language into computer code.",
  choice3: "additional hardware that can be added to the computer to increase arithmetic and logic calculations.",
  answer: 1},
  {question: "Mathematical calculations such as addition and subtraction are executed by the:",
  choice1: "register.",
  choice2: "arithmetic logical unit.",
  choice3: "control bus.",
  answer: 2},
  {question: "A triangle with a single input and a “o” on the output (right hand side corner of the triangle) is the symbol for a:",
  choice1: "“NOR” gate.",
  choice2: "“NOT” gate.",
  choice3: "“NAND” gate.",
  answer: 2},
  {question: "On a typical EFIS cockpit display, aircraft airspeed is indicated on the:",
  choice1: "PFD.",
  choice2: "ND.",
  choice3: "EICAS.",
  answer: 1},
  {question: "Single mode optical fibre:",
  choice1: "is usually used for long distance communications.",
  choice2: "uses incandescent lamps as the light source.",
  choice3: "is only used to manufacture patch cords.",
  answer: 1},
  {question: "How many lines can a 4-bit word address?",
  choice1: "16",
  choice2: "4",
  choice3: "256",
  answer: 1},
  {question: "A register is:",
  choice1: "an application subroutine.",
  choice2: "an external computer interface.",
  choice3: "a temporary storage location.",
  answer: 3},
  {question: "Aircraft speeds are displayed on the:",
  choice1: "EFIS display.",
  choice2: "EICAS display.",
  choice3: "ECAM display.",
  answer: 1},
  {question: "Which one of the following logic gates produces a high output when all inputs are low?",
  choice1: "NAND gate",
  choice2: "NOR gate",
  choice3: "Exclusive OR gate",
  answer: 1},
  {question: "An electrostatic discharge is caused by:",
  choice1: "electronic equipment being disconnected from the electrical system when the battery is still connected.",
  choice2: "the static discharge current created when the battery is disconnected.",
  choice3: "the transfer of a static electricity charge between two objects at different electrical potentials.",
  answer: 3},
  {question: "Static dischargers are usually connected to the:",
  choice1: "nose cone and leading edge of the primary flight control surfaces.",
  choice2: "fuselage and engine cowling.",
  choice3: "trailing edges of the primary flight control surfaces.",
  answer: 3},
  {question: "A two input NAND gate will have a low output when both of the inputs are:",
  choice1: "high.",
  choice2: "low.",
  choice3: "different.",
  answer: 1},
  {question: "A two input OR gate will have a low output when both of the inputs are:",
  choice1: "high.",
  choice2: "low.",
  choice3: "different.",
  answer: 2},
  {question: "Which one of the following types of cockpit display could experience an implosion if the screen is broken?",
  choice1: "LCD display",
  choice2: "Plasma display",
  choice3: "CRT display",
  answer: 3},
  {question: "The function of a “NOT” gate is to:",
  choice1: "invert the input condition.",
  choice2: "prevent loading on the output.",
  choice3: "disable the output.",
  answer: 1},
  {question: "A decoder that controls 256 separate outputs requires a device with a minimum of:",
  choice1: "8 input lines.",
  choice2: "16 input lines.",
  choice3: "128 input lines.",
  answer: 1},
  {question: "The purpose of the “parity bit” in communicating a group of bits from one system to another is to:",
  choice1: "tell whether there is an odd or even number of “1’s” in the group.",
  choice2: "provide a “word mark” to show that the character is the first of a group read together.",
  choice3: "warn the receiving unit that the message to follow contains an extra bit to detect errors in transmission.",
  answer: 3},
  {question: "The preferred way of joining a fibre-optic cable is by:",
  choice1: "a fusion splice.",
  choice2: "the application of an indexing gel.",
  choice3: "a mechanical splice.",
  answer: 1},
  {question: "An electronic flight indicating system (EFIS) control panel would include the:",
  choice1: "barometric altitude.",
  choice2: "captain’s display switching module.",
  choice3: "flight data recorder.",
  answer: 2},
  {question: "When making a fibre-optic termination, a microscope is used to:",
  choice1: "check the accuracy of a fusion splice.",
  choice2: "inspect the cable for cracks.",
  choice3: "inspect the end surface of a connector for flaws or dirt.",
  answer: 3},
  {question: "The shield on ARINC 429 cable should:",
  choice1: "be grounded at one end only.",
  choice2: "be grounded at both ends.",
  choice3: "not be grounded.",
  answer: 2},
  {question: "The voltage difference between the cathode and the anode of a colour cathode ray tube (CRT) screen is:",
  choice1: "approximately 400 volts.",
  choice2: "nominally 100 volts to 230 volts.",
  choice3: "greater than 10k volts.",
  answer: 3},
  {question: "In the Boolean statement F=(A+B)(C+D), if A = 1, B = 1, C = 1 and D = 0, then F must equal:",
  choice1: "1",
  choice2: "0",
  choice3: "2",
  answer: 1},
  {question: "To transmit several low bandwidth channels over a wide banthwidth channel requires the signals to be:",
  choice1: "amplified to the same voltage levels.",
  choice2: "modulated at the same frequency.",
  choice3: "multiplexed together.",
  answer: 2},
  {question: "The instrument system which displays hydraulic pressure is the:",
  choice1: "Electronic Horizontal Situation Indicator.",
  choice2: "Electronic Attitude Director Indicator.",
  choice3: "Engine Indication and Crew Alerting System.",
  answer: 3},
  {question: "Information which is being processed by a CPU is stored in the:",
  choice1: "registers.",
  choice2: "hard disk.",
  choice3: "peripheral devices.",
  answer: 1},
  {question: "Prior to servicing any Electro Static Discharge Sensitive component, a technician should:",
  choice1: "ensure no one else is working on the aircraft.",
  choice2: "wear a wrist strap connected to the aircraft electrical ground.",
  choice3: "unplug the battery cart from the aircraft.",
  answer: 2},
  {question: "For computing the position of an aircraft, the inertial navigation system measures:",
  choice1: "aircraft acceleration.",
  choice2: "airspeed.",
  choice3: "aircraft velocity.",
  answer: 3},
  {question: "The central processor unit of a computer consists of the:",
  choice1: "control, internal memory and the arithmetical logic unit.",
  choice2: "input/output devices and the external memory.",
  choice3: "arithmetical logic unit and the external memory.",
  answer: 1},
  {question: "Demultiplexer “data select” inputs control:",
  choice1: "which output line will be selected.",
  choice2: "when the inputs will be clocked to the output.",
  choice3: "how many inputs will be switched to the output.",
  answer: 1},
  {question: "EICAS (Engine Indication and Crew Alerting System) alert messages displayed on the aircraft upper display unit normally have how many levels?",
  choice1: "1",
  choice2: "2",
  choice3: "3",
  answer: 3},
  {question: "A flight management computer is an example of target:",
  choice1: "software.",
  choice2: "hardware.",
  choice3: "database.",
  answer: 3},
  {question: "The electrostatic “susceptibility symbol” is a:",
  choice1: "triangle, a reaching hand, and a slash through the reaching hand.",
  choice2: "red “X” on a white background.",
  choice3: "red “X” on a black background.",
  answer: 1},
  {question: "Timing for a CPU is generated from the:",
  choice1: "software.",
  choice2: "control bus.",
  choice3: "clock signal.",
  answer: 3},
  {question: "The illumination of a “carrier loss warning light” would probably indicate a:",
  choice1: "break in a fibre optic cable.",
  choice2: "loss of primary power.",
  choice3: "loss of information from the primary sensors.",
  answer: 3},
  {question: "A decoder with outputs of 0 to 7 requires:",
  choice1: "3 data select lines.",
  choice2: "2 data select lines.",
  choice3: "8 data select lines.",
  answer: 1},
  {question: "An eight-line multiplexer requires:",
  choice1: "eight data select control inputs.",
  choice2: "three data select control inputs.",
  choice3: "one data select control input.",
  answer: 2},
  {question: "An electronic attitude direction indicator (EADI) uses:",
  choice1: "an electronic display.",
  choice2: "an electro-mechanical display.",
  choice3: "a mechanical compass display system.",
  answer: 2},
  {question: "Information is transported to a CPU for processing by the:",
  choice1: "address bus.",
  choice2: "data bus.",
  choice3: "control bus.",
  answer: 2},
  {question: "Do all flip-flops in a register receive the same clock signal?",
  choice1: "Yes",
  choice2: "No",
  choice3: "Only in the case of shift registers.",
  answer: 1},
  {question: "Decoding of the two least significant bits would produce:",
  choice1: "a single output.",
  choice2: "two different outputs.",
  choice3: "four different outputs.",
  answer: 3},
  {question: "Turbine engine speed is usually indicated by:",
  choice1: "percentage.",
  choice2: "revolutions per second.",
  choice3: "revolutions per minute.",
  answer: 3},
  {question: "An ‘interrupt’ in computer technology is a:",
  choice1: "momentary but correctable break in communication between the CPU and an external device.",
  choice2: "signal that instructs the computer to perform a higher priority function.",
  choice3: "short delay in transmission to allow data synchronisation.",
  answer: 1},
  {question: "An electronic flight instrument system (EFIS) would normally present which of the following data to the flight crew?",
  choice1: "Attitude and navigation data.",
  choice2: "Attitude and engine data.",
  choice3: "Attitude and communication data.",
  answer: 1},
  {question: "The hexadecimal number that follows 9 is:",
  choice1: "A.",
  choice2: "10.",
  choice3: "F.",
  answer: 1},
  {question: "In microprocessors, the clock signal is:",
  choice1: "the master signal used for the pilot’s cockpit clock.",
  choice2: "the timing generator within the microprocessor.",
  choice3: "a device for measuring airframe hours",
  answer: 2},
  {question: "The strength in a fibre optic cable is provided by:",
  choice1: "having multiple fibre optic cores within the same cable sheath.",
  choice2: "a steel wire situated in the middle of the cable.",
  choice3: "an external steel catenary wire to support the fibre optic cable.",
  answer: 3},
  {question: "The main optical sources used in fibre optic transmission are:",
  choice1: "light emitting and laser diodes.",
  choice2: "low voltage quartz halogen bulbs and laser diodes.",
  choice3: "low voltage quartz halogen bulbs and light emitting diodes.",
  answer: 1},
  {question: "The binary representation of the decimal number 2 is:",
  choice1: "10.",
  choice2: "01.",
  choice3: "11.",
  answer: 1},
];

//CONSTANTS
const CORRECT_BONUS = 1;
const MAX_QUESTIONS = 72; //For CAT B2, total number of questions is 52.

startGame = () => {
  questionCounter = 0;
  score = 0;
  //SAR66 each topic scores
  localStorage.setItem("maxMark", MAX_QUESTIONS);
  availableQuesions = [...questions];
  quizname.innerText = `M5: Digital`;
  getNewQuestion();
};

getNewQuestion = () => {
  if (availableQuesions.length === 0 || questionCounter >= MAX_QUESTIONS) {
    localStorage.setItem("mostRecentScore", score);
    //Generating the topic results
    //go to the end page
    return window.location.assign("../end.html");
  }
  questionCounter++;
  progressText.innerText = `Question ${questionCounter}/${MAX_QUESTIONS}`;
  //Update the progress bar
  progressBarFull.style.width = `${(questionCounter / MAX_QUESTIONS) * 100}%`;

  const questionIndex = Math.floor(Math.random() * availableQuesions.length);
  currentQuestion = availableQuesions[questionIndex];
  question.innerText = currentQuestion.question;

  choices.forEach(choice => {
    const number = choice.dataset["number"];
    choice.innerText = currentQuestion["choice" + number];
  });

  availableQuesions.splice(questionIndex, 1);
  acceptingAnswers = true;
};

choices.forEach(choice => {
  choice.addEventListener("click", e => {
    if (!acceptingAnswers) return;

    acceptingAnswers = false;
    const selectedChoice = e.target;
    const selectedAnswer = selectedChoice.dataset["number"];

    const classToApply = selectedAnswer == currentQuestion.answer ? "correct" : "incorrect";

    if (classToApply === "correct") {incrementScore(CORRECT_BONUS);};

    selectedChoice.parentElement.classList.add(classToApply);

    setTimeout(() => {
      selectedChoice.parentElement.classList.remove(classToApply);
      getNewQuestion();
    }, 1000);
  });
});

incrementScore = num => {
  score += num;
  scoreText.innerText = score;
};

startGame();
